/* ── Reset & Base ─────────────────────────────────────────────────────────── */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

:root {
  --bg: #0f1117;
  --bg2: #1a1d27;
  --bg3: #23263a;
  --border: #2e3248;
  --text: #e2e5f1;
  --text-dim: #7880a0;
  --accent: #4f8ef7;
  --accent-dim: #2d5cbf;
  --green: #2ecc71;
  --red: #e74c3c;
  --yellow: #f1c40f;
  --orange: #e67e22;
  --purple: #9b59b6;
  --teal: #1abc9c;
  --font: 'Segoe UI', system-ui, sans-serif;
  --mono: 'Cascadia Code', 'Consolas', monospace;
}

html, body {
  height: 100%;
  background: var(--bg);
  color: var(--text);
  font-family: var(--font);
  font-size: 14px;
  line-height: 1.5;
}

/* ── Screens ──────────────────────────────────────────────────────────────── */
.screen { display: none; height: 100vh; flex-direction: column; overflow: hidden; }
.screen.active { display: flex; }

/* ── Buttons ──────────────────────────────────────────────────────────────── */
.btn {
  display: inline-flex; align-items: center; justify-content: center;
  padding: 6px 14px; border-radius: 6px; border: none; cursor: pointer;
  font-size: 13px; font-weight: 600; transition: background 0.15s, opacity 0.15s;
  white-space: nowrap;
}
.btn:disabled { opacity: 0.4; cursor: default; }
.btn-primary { background: var(--accent); color: #fff; }
.btn-primary:hover:not(:disabled) { background: var(--accent-dim); }
.btn-secondary { background: var(--bg3); color: var(--text); border: 1px solid var(--border); }
.btn-secondary:hover:not(:disabled) { background: var(--border); }
.btn-sm { padding: 4px 10px; font-size: 12px; }
.btn-icon { background: none; border: none; cursor: pointer; color: var(--text-dim); font-size: 18px; padding: 4px 8px; }
.btn-icon:hover { color: var(--text); }

/* ── App Header ───────────────────────────────────────────────────────────── */
.app-header {
  display: flex; align-items: center; justify-content: space-between;
  padding: 10px 20px; background: var(--bg2); border-bottom: 1px solid var(--border);
  flex-shrink: 0;
}
.app-header h1 { font-size: 20px; letter-spacing: 1px; color: var(--accent); }
.header-actions { display: flex; gap: 8px; }

/* ── Game List ────────────────────────────────────────────────────────────── */
#gamelist-screen .gamelist-main {
  flex: 1; overflow-y: auto; padding: 20px;
}

#games-table {
  width: 100%; border-collapse: collapse;
}
#games-table th, #games-table td {
  padding: 10px 14px; text-align: left; border-bottom: 1px solid var(--border);
}
#games-table th { color: var(--text-dim); font-weight: 600; font-size: 12px; text-transform: uppercase; letter-spacing: 0.5px; }
#games-table tbody tr:hover { background: var(--bg2); }
#games-table .row-actions { display: flex; gap: 6px; }
#games-empty-row td { color: var(--text-dim); text-align: center; padding: 40px; }

/* ── Setup ────────────────────────────────────────────────────────────────── */
#setup-screen .setup-main {
  flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 24px;
}
.setup-section { background: var(--bg2); border-radius: 10px; padding: 20px; border: 1px solid var(--border); }
.setup-section h2 { font-size: 15px; margin-bottom: 16px; color: var(--text-dim); text-transform: uppercase; letter-spacing: 0.5px; }
.field-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 12px; }
.field-grid label { display: flex; flex-direction: column; gap: 4px; font-size: 12px; color: var(--text-dim); }
.field-grid input[type="text"],
.field-grid input[type="url"],
.field-grid input[type="datetime-local"],
.field-grid select {
  background: var(--bg3); border: 1px solid var(--border); border-radius: 6px;
  color: var(--text); padding: 7px 10px; font-size: 13px; font-family: var(--font);
}
.field-grid input:focus { outline: none; border-color: var(--accent); }
.required-mark { color: var(--red); margin-left: 2px; }
.checkbox-label { flex-direction: row !important; align-items: center; gap: 8px; color: var(--text) !important; font-size: 13px !important; cursor: pointer; }
.video-url-field { display: flex; flex-direction: column; gap: 4px; }
.video-url-field > label { font-size: 12px; color: var(--text-dim); display: flex; flex-direction: column; gap: 4px; }
.video-url-row { display: flex; gap: 8px; align-items: center; }
.video-url-row input { flex: 1; background: var(--bg3); border: 1px solid var(--border); border-radius: 6px; color: var(--text); padding: 7px 10px; font-size: 13px; font-family: var(--font); }
.video-url-row input:focus { outline: none; border-color: var(--accent); }
.video-preview-area { margin-top: 8px; border-radius: 6px; overflow: hidden; }
.video-preview-iframe { width: 100%; height: 220px; border: none; display: block; }
.video-preview-native { width: 100%; max-height: 220px; display: block; background: #000; }

/* Colour picker */
.colour-select { position: relative; }
.colour-select-btn {
  display: flex; align-items: center; gap: 8px;
  background: var(--bg3); border: 1px solid var(--border); border-radius: 6px;
  color: var(--text); padding: 7px 10px; font-size: 13px; cursor: pointer;
  width: 100%; text-align: left;
}
.colour-select-btn:hover { border-color: var(--accent); }
.colour-swatch {
  display: inline-block; width: 16px; height: 16px; border-radius: 3px;
  border: 1px solid rgba(255,255,255,0.15); flex-shrink: 0;
}
.colour-swatch-none { background: repeating-linear-gradient(45deg, #444 0, #444 3px, #222 3px, #222 6px); }
.colour-dropdown {
  position: absolute; top: 100%; left: 0; right: 0; z-index: 50;
  background: var(--bg2); border: 1px solid var(--accent); border-radius: 8px;
  padding: 6px; display: grid; grid-template-columns: repeat(3, 1fr); gap: 4px;
  margin-top: 2px; box-shadow: 0 4px 16px rgba(0,0,0,0.4);
}
.colour-dropdown[hidden] { display: none; }
.colour-option {
  display: flex; align-items: center; gap: 6px;
  padding: 6px 8px; border-radius: 5px; cursor: pointer; font-size: 12px;
}
.colour-option:hover { background: var(--bg3); }
.colour-option.selected { background: rgba(79,142,247,0.15); outline: 1px solid var(--accent); }
.checkbox-label input[type="checkbox"] { width: 16px; height: 16px; accent-color: var(--accent); }

/* Roster */
.roster-panels { display: flex; gap: 16px; flex-wrap: wrap; }
.roster-panel { flex: 1; min-width: 280px; border: 1px solid var(--border); border-radius: 8px; overflow: hidden; }
.roster-toggle {
  width: 100%; background: var(--bg3); border: none; color: var(--text);
  padding: 10px 14px; text-align: left; cursor: pointer; font-size: 13px;
  display: flex; align-items: center; gap: 8px;
}
.roster-toggle:hover { background: var(--border); }
.toggle-arrow { margin-left: auto; transition: transform 0.2s; }
.roster-toggle.open .toggle-arrow { transform: rotate(90deg); }
.roster-body { padding: 10px; display: flex; flex-direction: column; gap: 8px; }
.roster-table { width: 100%; border-collapse: collapse; font-size: 12px; }
.roster-table th, .roster-table td { padding: 5px 8px; border-bottom: 1px solid var(--border); }
.roster-table th { color: var(--text-dim); }
.roster-add-form { display: flex; gap: 6px; align-items: center; }
.roster-add-form input { flex: 1; background: var(--bg3); border: 1px solid var(--border); border-radius: 5px; color: var(--text); padding: 5px 8px; font-size: 12px; }
.roster-add-form input:focus { outline: none; border-color: var(--accent); }
.roster-input-jersey { max-width: 50px !important; }
.roster-paste-input { width: 100%; height: 80px; background: var(--bg3); border: 1px solid var(--border); border-radius: 5px; color: var(--text); padding: 6px 8px; font-family: var(--mono); font-size: 12px; resize: vertical; }
.roster-paste-buttons { display: flex; gap: 6px; margin-top: 4px; }
.roster-actions { display: flex; gap: 6px; }
.roster-count { color: var(--text-dim); font-size: 12px; }

/* ── Game Events Screen ───────────────────────────────────────────────────── */
#gameevents-screen {
  display: none;
  grid-template-rows: auto 1fr auto auto auto;
  grid-template-columns: 1fr;
  height: 100vh;
}
#gameevents-screen.active { display: grid; }

/* Scoreboard */
#scoreboard-bar {
  display: flex; align-items: center; justify-content: space-between;
  background: var(--bg2); border-bottom: 1px solid var(--border);
  padding: 8px 20px; gap: 20px;
}
.score-team { display: flex; align-items: center; gap: 12px; min-width: 160px; }
#score-team-b { flex-direction: row-reverse; }
.team-name { font-size: 15px; font-weight: 700; }
.team-score { font-size: 32px; font-weight: 900; color: var(--accent); min-width: 50px; text-align: center; }
.score-center { display: flex; flex-direction: column; align-items: center; gap: 6px; }
.clock-info { font-size: 18px; font-weight: 700; font-variant-numeric: tabular-nums; }
.clock-buttons { display: flex; gap: 8px; }
.btn-clock { font-size: 11px; padding: 4px 12px; border-radius: 4px; font-weight: 800; letter-spacing: 1px; }
.btn-start { background: var(--green); color: #fff; }
.btn-start:hover { background: #27ae60; }
.btn-stop { background: var(--red); color: #fff; }
.btn-stop:hover { background: #c0392b; }
.btn-continue { background: #1a8c72; color: #fff; }
.btn-continue:hover { background: #148060; }
.btn-clock:disabled { opacity: 0.35; cursor: not-allowed; }

/* Warning toast */
.warning-toast { position: fixed; bottom: 24px; left: 50%; transform: translateX(-50%); background: #7a4800; border: 1px solid var(--orange); color: #ffd9a0; padding: 10px 20px; border-radius: 6px; font-size: 13px; z-index: 2000; max-width: 480px; text-align: center; white-space: pre-line; }
.warning-toast[hidden] { display: none; }

/* Undo toast */
.undo-toast { position: fixed; bottom: 24px; right: 24px; background: var(--bg3); border: 1px solid var(--border); color: var(--text); padding: 10px 16px; border-radius: 6px; font-size: 13px; z-index: 2000; display: flex; align-items: center; gap: 14px; }
.undo-toast[hidden] { display: none; }

/* Lineup picker */
.lineup-count { font-size: 13px; color: var(--text-dim); margin-bottom: 10px; }
.lineup-list { display: flex; flex-direction: column; gap: 4px; max-height: 320px; overflow-y: auto; }
.lineup-player { display: flex; align-items: center; gap: 10px; padding: 6px 8px; border-radius: 4px; cursor: pointer; user-select: none; }
.lineup-player:hover { background: var(--bg3); }
.lineup-player input[type="checkbox"] { width: 16px; height: 16px; cursor: pointer; }

/* Video */
#video-section {
  position: relative; background: #000; overflow: hidden; min-height: 0;
}
#video-wrapper {
  width: 85%; height: 100%; margin: 0 auto; position: relative;
}
#game-video { position: absolute !important; top: 0; left: 0; width: 100% !important; height: 100% !important; }

/* Seekbar */
#seekbar-wrap {
  background: var(--bg2); border-top: 1px solid var(--border);
  padding: 6px 12px; cursor: pointer; height: 36px;
}
#seekbar-canvas { width: 100%; height: 24px; display: block; cursor: ew-resize; user-select: none; }

/* Video Controls */
#video-controls {
  display: flex; align-items: center; gap: 8px; padding: 8px 16px;
  background: var(--bg2); border-top: 1px solid var(--border);
}
.btn-ctrl { background: var(--bg3); border: 1px solid var(--border); color: var(--text); padding: 5px 12px; font-size: 12px; }
.btn-ctrl:hover { background: var(--border); }
.btn-play { min-width: 44px; }
.speed-select {
  background: var(--bg3); border: 1px solid var(--border); color: var(--text);
  padding: 5px 8px; border-radius: 6px; font-size: 12px;
}
#vc-time { margin-left: auto; font-variant-numeric: tabular-nums; color: var(--text-dim); font-size: 12px; }

/* Event Panel */
#event-panel {
  display: flex; flex-direction: column; background: var(--bg2);
  border-top: 1px solid var(--border); max-height: 32vh; min-height: 0;
}
.event-panel-header {
  display: flex; align-items: center; justify-content: space-between;
  padding: 6px 12px; border-bottom: 1px solid var(--border); flex-shrink: 0;
}
.event-panel-tabs { display: flex; gap: 4px; }
.tab-btn {
  background: none; border: 1px solid transparent; border-radius: 5px;
  color: var(--text-dim); padding: 4px 12px; cursor: pointer; font-size: 12px;
}
.tab-btn.active { background: var(--bg3); border-color: var(--border); color: var(--text); }
.event-panel-actions { display: flex; gap: 6px; }
.tab-pane { flex: 1; overflow-y: auto; }

#events-table { width: 100%; border-collapse: collapse; font-size: 12px; }
#events-table th, #events-table td { padding: 7px 12px; border-bottom: 1px solid var(--border); text-align: left; }
#events-table th { position: sticky; top: 0; background: var(--bg2); color: var(--text-dim); font-size: 11px; text-transform: uppercase; }
#events-table tbody tr[data-idx] { cursor: pointer; }
#events-table tbody tr:hover { background: var(--bg3); }
#events-table tr.current-row { background: rgba(79,142,247,0.12); }
#events-table .row-actions { display: flex; gap: 4px; }
.type-badge {
  display: inline-block; padding: 2px 7px; border-radius: 4px;
  font-size: 11px; font-weight: 700; text-transform: uppercase;
}
.badge-clock { background: #1a3a5c; color: #4f8ef7; }
.badge-shot { background: #1a3a1a; color: #2ecc71; }
.badge-foul { background: #3a1a1a; color: #e74c3c; }
.badge-violation { background: #3a2a1a; color: #e67e22; }
.badge-lineup { background: #2a1a3a; color: #9b59b6; }
.badge-rebound { background: #1a3a3a; color: #1abc9c; }
.badge-turnover { background: #3a3a1a; color: #f1c40f; }
.badge-score { background: #2a2a2a; color: #bdc3c7; }

#bgdl-text-editor {
  width: 100%; flex: 1; background: var(--bg); border: none; color: var(--text);
  font-family: var(--mono); font-size: 12px; padding: 10px 14px; resize: none;
  height: calc(100% - 36px);
}
#bgdl-text-editor:focus { outline: none; }
.bgdl-editor-actions {
  display: flex; align-items: center; gap: 10px; padding: 6px 12px;
  border-top: 1px solid var(--border); flex-shrink: 0;
}
#bgdl-parse-status { font-size: 12px; flex: 1; }
#bgdl-parse-status.ok { color: var(--green); }
#bgdl-parse-status.err { color: var(--red); }

/* ── Entry Modal ──────────────────────────────────────────────────────────── */
.modal { position: fixed; inset: 0; z-index: 100; display: flex; align-items: center; justify-content: center; }
.modal[hidden] { display: none; }
.modal-backdrop { position: absolute; inset: 0; background: rgba(0,0,0,0.7); }
.modal-box {
  position: relative; background: var(--bg2); border: 1px solid var(--border);
  border-radius: 12px; width: min(600px, 95vw); max-height: 90vh;
  display: flex; flex-direction: column; overflow: hidden;
}
.modal-header {
  display: flex; align-items: center; gap: 12px;
  padding: 14px 18px; border-bottom: 1px solid var(--border); flex-shrink: 0;
}
.modal-header h2 { font-size: 16px; flex: 1; }
.modal-mode-toggle { display: flex; border: 1px solid var(--border); border-radius: 6px; overflow: hidden; }
.mode-btn { background: none; border: none; color: var(--text-dim); padding: 5px 14px; cursor: pointer; font-size: 12px; }
.mode-btn.active { background: var(--accent); color: #fff; }
.modal-body { flex: 1; overflow-y: auto; padding: 16px 18px; }
.modal-footer { border-top: 1px solid var(--border); padding: 12px 18px; display: flex; flex-direction: column; gap: 10px; flex-shrink: 0; }
.time-row { display: flex; gap: 12px; }
.time-row label { display: flex; flex-direction: column; gap: 4px; font-size: 12px; color: var(--text-dim); flex: 1; }
.time-row input {
  background: var(--bg3); border: 1px solid var(--border); border-radius: 5px;
  color: var(--text); padding: 6px 10px; font-size: 13px; font-family: var(--mono);
}
.time-row input:focus { outline: none; border-color: var(--accent); }
.modal-buttons { display: flex; justify-content: flex-end; gap: 8px; }

/* Type grid */
.type-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(130px, 1fr)); gap: 8px; }
.type-btn {
  display: flex; flex-direction: column; align-items: center; gap: 4px;
  padding: 12px 8px; border-radius: 8px; border: 1px solid var(--border);
  background: var(--bg3); cursor: pointer; transition: border-color 0.15s, background 0.15s;
}
.type-btn:hover { border-color: var(--accent); background: var(--bg); }
.type-btn .type-icon { font-size: 20px; }
.type-btn .type-label { font-size: 11px; font-weight: 600; text-align: center; color: var(--text-dim); }

/* Entry fields */
.entry-field { margin-bottom: 12px; }
.entry-field label { display: block; font-size: 12px; color: var(--text-dim); margin-bottom: 4px; }
.entry-field input[type="text"],
.entry-field select {
  width: 100%; background: var(--bg3); border: 1px solid var(--border); border-radius: 6px;
  color: var(--text); padding: 7px 10px; font-size: 13px;
}
.entry-field input:focus, .entry-field select:focus { outline: none; border-color: var(--accent); }
.toggle-row { display: flex; gap: 0; border: 1px solid var(--border); border-radius: 6px; overflow: hidden; width: fit-content; }
.toggle-option { padding: 6px 16px; background: none; border: none; color: var(--text-dim); cursor: pointer; font-size: 13px; }
.toggle-option.active { background: var(--accent); color: #fff; }

/* BGDL direct entry */
.bgdl-entry-wrap { display: flex; align-items: center; gap: 8px; margin-bottom: 10px; }
.bgdl-entry-prefix { font-family: var(--mono); color: var(--text-dim); font-size: 13px; white-space: nowrap; }
.bgdl-entry-input {
  flex: 1; background: var(--bg3); border: 1px solid var(--border); border-radius: 6px;
  color: var(--text); padding: 8px 12px; font-family: var(--mono); font-size: 13px;
}
.bgdl-entry-input:focus { outline: none; border-color: var(--accent); }
.bgdl-entry-preview {
  background: var(--bg3); border-radius: 6px; padding: 10px 14px;
  font-size: 13px; color: var(--text-dim); min-height: 38px;
  border: 1px solid var(--border);
}
.bgdl-entry-preview.valid { border-color: var(--green); color: var(--text); }
.bgdl-entry-preview.invalid { border-color: var(--red); color: var(--red); }

/* Player selector (searchable dropdown) */
.player-select-wrap { position: relative; }
.player-select-wrap input {
  width: 100%; background: var(--bg3); border: 1px solid var(--border); border-radius: 6px;
  color: var(--text); padding: 7px 10px; font-size: 13px;
}
.player-select-wrap input:focus { outline: none; border-color: var(--accent); }
.player-dropdown {
  position: absolute; top: 100%; left: 0; right: 0; z-index: 10;
  background: var(--bg2); border: 1px solid var(--accent); border-radius: 6px;
  max-height: 160px; overflow-y: auto;
}
.player-dropdown-item {
  padding: 7px 12px; cursor: pointer; font-size: 13px;
}
.player-dropdown-item:hover { background: var(--bg3); }

/* Shot location grid */
.region-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 4px; margin-top: 6px; }
.region-btn {
  padding: 5px 4px; font-size: 11px; border: 1px solid var(--border);
  border-radius: 4px; background: var(--bg3); color: var(--text-dim); cursor: pointer;
  text-align: center;
}
.region-btn.selected { border-color: var(--accent); color: var(--accent); background: rgba(79,142,247,0.1); }
.region-btn.zone-3 { border-color: #3a2800; }
.region-btn.zone-3.selected { border-color: var(--yellow); color: var(--yellow); background: rgba(241,196,15,0.1); }
